<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>YaCy '#[clientname]#': Local Cache Management</title>
    #%env/templates/metas.template%#
  </head>
  <body id="CrawlURLFetch_p">
    #%env/templates/header.template%#
    <h2>URL-Fetcher</h2>
    <form method="post" action="CrawlURLFetch_p.html" enctype="multipart/form-data">
      <fieldset><legend>Fetch new URLs to crawl</legend>
        <p>
          The newly added URLs will be crawled without any filter restricions except of the <em>static</em> stop-words.
          The Re-Crawl option isn't used and the sites won't be stored in the Proxy Cache. Text and media types will be indexed.
          Since these URLs are explicitely requested from another peer, they won't be distributed for remote indexing.
        </p>
        <dl>
          <dt><label for="url">Fetch from URL</label>:</dt>
          <dd>
            <input type="radio" name="source" value="url" id="url" checked="checked" />
            <input type="text" id="host" name="host" size="60" value="#[host]#" />
            #(saved)#::<br />
            Or select previously entered URL: <select name="savedURL">#{urls}#
              <option>#[url]#</option>
            </select>#(/saved)#
            #(hostError)#::&nbsp;<span class="error">Malformed URL</span>#(/hostError)#
          </dd>
          
          #(peersKnown)#::
          <dt><label for="peer">Fetch from Peer</label>:</dt>
          <dd>
            <input type="radio" name="source" value="peer" id="peer" disabled="disabled" />
            <select name="peerhash" disabled="disabled">
              <option value="random" selected="selected">Choose a random peer</option>#{peers}# 
              <option value="#[hash]#">#[name]#</option>#{/peers}# 
            </select>
            #(peerError)#::
            &nbsp;<span class="error">Error fetching URL-list from <span class="tt">#[hash]#:#[name]#</span></span>::
            &nbsp;<span class="error">Peer with hash <span class="tt">#[hash]#</span> doesn't seem to be online anymore</span>#(/peerError)#
          </dd>#(/peersKnown)#
          
          <dt>Frequency:</dt>
          <dd>
            <input type="radio" name="reg" value="once" id="once" checked="checked" /> <label for="once">Fetch only once</label><br />
            <input type="radio" name="reg" value="self_det" id="self_det" disabled="disabled"/> <label for="self_det">Fetch when queue is empty</label><br />
            <input type="radio" name="reg" value="delay" id="delay" /> <label for="delay">Fetch in a specified delay</label>:
            <label for="frequency">every</label>
            &nbsp;<input type="text" name="frequency" id="frequency" text-align="left" size="2" style="text-align: right;" maxlength="2"/>
            <select name="freq_type">
              <option value="weeks">Weeks</option>
              <option value="days" selected="selected">Days</option>
              <option value="hours">Hours</option>
            </select>
            #(freqError)#::&nbsp;<span class="error">Invalid period, fetching only once</span>#(/freqError)#
          </dd>
          <dt><input type="submit" name="start" value="Fetch URLs" /></dt>
        </dl>
      </fieldset>
      
      #(threadError)#::
      <span class="error">Error on stopping thread, it isn't alive anymore</span>::
      <span class="error">Error on restarting thread, it isn't alive anymore</span>#(/threadError)#
      
      #(runs)#::
      <fieldset><legend>Thread to fetch URLs is #(status)#running::stopped::paused#(/status)#</legend>
        <dl>
          <dt>Total runs:</dt><dd>#[totalRuns]#</dd>
          <dt>Last run duration:</dt><dd>#[lastRun]#</dd>
          <dt>Last server response:</dt><dd>#[lastServerResponse]#</dd>
          <dt>Total fetched URLs:</dt><dd>#[totalFetchedURLs]#</dd>
          <dt>Total failed URLs:</dt><dd>#[totalFailedURLs]#</dd>
          <dt>Last fetched URLs:</dt><dd>#[lastFetchedURLs]#</dd>
          <dt>Failed URLs:</dt>
          <dd>
            #[error]#
            <ul>#{error}# 
              <li><span class="error">#[reason]#</span>: #[url]#</li>#{/error}#
            </ul> 
          </dd>
          <dt>#(status)#
            <input type="submit" name="stop" value="Stop Thread" />::
            <input type="submit" name="restart" value="Restart Thread" />::
            <input type="submit" name="resume" value="Resume Thread" />#(/status)#
          </dt>
        </dl>
      </fieldset>
      #(/runs)#
    </form>
    #%env/templates/footer.template%#
  </body>
</html>