<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>YaCy '#[clientname]#': URL Fetcher Management</title>
    #%env/templates/metas.template%#
  </head>
  <body id="CrawlURLFetch_p">
    #%env/templates/header.template%#
    #%env/templates/submenuCrawlURLFetch.template%#
    <h2>URL-Fetcher</h2>
    <form method="post" action="CrawlURLFetch_p.html" enctype="multipart/form-data">
      <fieldset><legend>Fetch new URLs to crawl</legend>
        <p>
          The newly added URLs will be crawled without any filter restricions except of the <em>static</em> stop-words.
          The Re-Crawl option isn't used and the sites won't be stored in the Proxy Cache. Text and media types will be indexed.
          Since these URLs will be requested explicitely from another peer, they won't be distributed for remote indexing.
        </p>
        <dl>
          <dt><label for="url">Fetch from URL</label>:</dt>
          <dd>
            <input type="radio" name="source" value="url" id="url" checked="checked" />
            <input type="text" id="host" name="host" size="60" value="#[host]#" />
            #(hostError)#::&nbsp;<span class="error">Malformed URL</span>#(/hostError)#
            #(saved)#::
          </dd>
          <dt><label for="savedURL">Or select previously entered URL</label>:</dt>
          <dd>
            <input type="radio" name="source" id="savedURL" value="saved" />
            <select name="saved">#{urls}#
              <option>#[url]#</option>#{/urls}# 
            </select>#(/saved)#
          </dd>
          
          #(peersKnown)#::
          <dt><label for="peer">Fetch from Peer</label>:</dt>
          <dd>
            <input type="radio" name="source" value="peer" id="peer" />
            <select name="peerhash">
              <option value="random" selected="selected">Choose a random peer</option>#{peers}# 
              <option value="#[hash]#">#[name]#</option>#{/peers}# 
            </select>
            <input type="submit" name="checkPeerURLCount" value="Check URL count" />
            &nbsp;<label for="amount">Amount of URLs to request</label>:
            <input type="text" name="amount" id="amount" value="50" maxlength="3" size="3" />
            #(peerError)#::
            &nbsp;<span class="error">Error fetching URL-list from <span class="tt">#[hash]#:#[name]#</span></span>::
            &nbsp;<span class="error">Peer with hash <span class="tt">#[hash]#</span> doesn't seem to be online anymore</span>#(/peerError)#
          </dd>#(/peersKnown)#
          
          <dt>Frequency:</dt>
          <dd>
            <input type="radio" name="reg" value="once" id="once" checked="checked" /> <label for="once">Fetch only once</label><br />
            <input type="radio" name="reg" value="self_det" id="self_det" disabled="disabled"/> <label for="self_det">Fetch when queue is empty</label><br />
            <input type="radio" name="reg" value="delay" id="delay" /> <label for="delay">Fetch in a specified delay</label>:
            <label for="frequency">every</label>
            &nbsp;<input type="text" name="frequency" id="frequency" size="2" style="text-align: right;" maxlength="2"/>
            <select name="freq_type">
              <option value="days">Days</option>
              <option value="hours" selected="selected">Hours</option>
              <option value="minutes">Minutes</option>
            </select>
            #(freqError)#::&nbsp;<span class="error">Invalid period, fetching only once</span>#(/freqError)#
          </dd>
          <dt><input type="submit" name="start" value="Fetch URLs" /></dt>
        </dl>
      </fieldset>
    </form>
    
    #(threadError)#::
    <span class="error">Error on stopping thread, it isn't alive anymore</span>::
    <span class="error">Error on restarting thread, it isn't alive anymore</span>#(/threadError)#
    
    #(runs)#::
    <form method="post" action="CrawlURLFetch_p.html" enctype="multipart/form-data">
      <fieldset><legend>Thread to fetch URLs is #(status)#running::stopped::paused#(/status)#</legend>
        <dl>
          <dt>Total runs:</dt><dd>#[totalRuns]#</dd>
          <dt>Total fetched URLs:</dt><dd>#[totalFetchedURLs]#</dd>
          <dt>Total failed URLs:</dt><dd>#[totalFailedURLs]#</dd>
          <dt>Last run duration:</dt><dd>#[lastRun]# ms</dd>
          <dt>Last server response:</dt><dd>#[lastServerResponse]#</dd>
          <dt>Last fetched URLs:</dt><dd>#[lastFetchedURLs]#</dd>
          <dt>Failed URLs:</dt>
          <dd>
            #[error]#
            <ul>#{error}# 
              <li><span class="error">#[reason]#</span>: <a href="#[url]#">#[url]#</a></li>#{/error}# 
            </ul> 
          </dd>
          <dt>#(status)#
            <input type="submit" name="stop" value="Stop Thread" />::
            <input type="submit" name="restart" value="Restart Thread" />::
            <input type="submit" name="stop" value="Stop Thread" />
            <input type="submit" name="restart" value="Restart Thread" />#(/status)#
          </dt>
        </dl>
      </fieldset>
    </form>
    #(/runs)#
    #%env/templates/footer.template%#
  </body>
</html>